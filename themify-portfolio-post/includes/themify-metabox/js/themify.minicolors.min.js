!function($){"use strict";function i(t){const e=t.parent();t.removeData("tfminicolors-initialized").removeData("tfminicolors-settings").removeProp("size").removeClass("tfminicolors-input"),e.before(t).remove()}function l(t){var e=t.parent(),i=e.find(".tfminicolors-panel"),o=t.data("tfminicolors-settings"),s=document.body.contains(t[0])?document:top.document;!t.data("tfminicolors-initialized")||t.prop("disabled")||e.hasClass("tfminicolors-inline")||e.hasClass("tfminicolors-focus")||(h(window.top.document),e.addClass("tfminicolors-focus"),i.animate?i.stop(!0,!0).fadeIn(o.showSpeed,function(){o.show&&o.show.call(t.get(0))}):(i.show(),o.show&&o.show.call(t.get(0))),$(s).on("mousedown.tfminicolors touchstart.tfminicolors",function(t){1===t.which&&0===$(t.target).closest(".tfminicolors,.tfminicolors_wrapper").length&&($(this).off("mousemove.tfminicolors touchmove.tfminicolors mousedown.tfminicolors touchstart.tfminicolors mouseup.tfminicolors touchend.tfminicolors"),h(this),0)}))}function h(t){$(".tfminicolors-focus",t).each(function(){const t=$(this),e=t.find(".tfminicolors-input"),i=t.find(".tfminicolors-panel"),o=e.data("tfminicolors-settings");i.animate?i.fadeOut(o.hideSpeed,function(){o.hide&&o.hide.call(e.get(0)),t.removeClass("tfminicolors-focus")}):(i.hide(),o.hide&&o.hide.call(e.get(0)),t.removeClass("tfminicolors-focus"))})}function d(t,e,i){let o=t.parents(".tfminicolors").find(".tfminicolors-input"),s=o.data("tfminicolors-settings"),a=t.find("[class$=-picker]"),n=t.offset().left,r=t.offset().top,c=Math.round(e.pageX-n),l=Math.round(e.pageY-r),h=i?s.animationSpeed:0,d,f,p,m,u;e.originalEvent.changedTouches&&(c=e.originalEvent.changedTouches[0].pageX-n,l=e.originalEvent.changedTouches[0].pageY-r),c<0&&(c=0),l<0&&(l=0),c>t.width()&&(c=t.width()),l>t.height()&&(l=t.height()),t.parent().hasClass("tfminicolors-slider-wheel")&&a.parent().hasClass("tfminicolors-grid")&&(d=75-c,f=75-l,p=Math.sqrt(d*d+f*f),(m=Math.atan2(f,d))<0&&(m+=2*Math.PI),75<p&&(c=75-75*Math.cos(m),l=75-75*Math.sin(m)),c=Math.round(c),l=Math.round(l)),u={top:l+"px"},t.is(".tfminicolors-grid")&&(u.left=c+"px"),a.animate?a.stop(!0).animate(u,h,s.animationEasing,function(){g(o,t)}):(a.css(u),g(o,t))}function g(t,e){function i(t,e){return t.length&&e?{x:t.offset().left-e.offset().left+t.outerWidth()/2,y:t.offset().top-e.offset().top+t.outerHeight()/2}:null}let o,s,a,n,r,c,l,h=t.val(),d=t.attr("data-opacity"),f=t.parent(),p=t.data("tfminicolors-settings"),m=f.find(".tfminicolors-input-swatch"),u=f.find(".tfminicolors-grid"),g=f.find(".tfminicolors-slider"),w=f.find(".tfminicolors-opacity-slider"),b=u.find("[class$=-picker]"),y=g.find("[class$=-picker]"),v=w.find("[class$=-picker]"),C=i(b,u),k=i(y,g),_=i(v,w);if(e.is(".tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider")){switch(p.control){case"wheel":n=u.width()/2-C.x,r=u.height()/2-C.y,c=Math.sqrt(n*n+r*r),(l=Math.atan2(r,n))<0&&(l+=2*Math.PI),75<c&&(c=75,C.x=69-75*Math.cos(l),C.y=69-75*Math.sin(l)),s=N(c/.75,0,100),o=N(180*l/Math.PI,0,360),a=N(100-Math.floor(100*k.y/g.height()),0,100),h=j({h:o,s:s,b:a}),g.css("backgroundColor",j({h:o,s:s,b:100}));break;case"saturation":o=N(parseInt(360*C.x/u.width(),10),0,360),s=N(100-Math.floor(100*k.y/g.height()),0,100),a=N(100-Math.floor(100*C.y/u.height()),0,100),h=j({h:o,s:s,b:a}),g.css("backgroundColor",j({h:o,s:100,b:a})),f.find(".tfminicolors-grid-inner").css("opacity",s/100);break;case"brightness":o=N(parseInt(360*C.x/u.width(),10),0,360),s=N(100-Math.floor(100*C.y/u.height()),0,100),a=N(100-Math.floor(100*k.y/g.height()),0,100),h=j({h:o,s:s,b:a}),g.css("backgroundColor",j({h:o,s:s,b:100})),f.find(".tfminicolors-grid-inner").css("opacity",1-a/100);break;default:o=N(360-parseInt(360*k.y/g.height(),10),0,360),s=N(Math.floor(100*C.x/u.width()),0,100),a=N(100-Math.floor(100*C.y/u.height()),0,100),h=j({h:o,s:s,b:a}),u.css("backgroundColor",j({h:o,s:100,b:100}));break}d=p.opacity?parseFloat(1-_.y/w.height()).toFixed(2):1,S(t,h,d)}else m.find("span").css({backgroundColor:h,opacity:d}),M(t,h,d)}function S(t,e,i){let o,s=t.parent(),a=t.data("tfminicolors-settings"),n=s.find(".tfminicolors-input-swatch");a.opacity&&t.attr("data-opacity",i),e="rgb"===a.format?(o=E(e)?_(e,!0):F(k(e,!0)),i=""===t.attr("data-opacity")?1:N(parseFloat(t.attr("data-opacity")).toFixed(2),0,1),!isNaN(i)&&a.opacity||(i=1),t.tfminicolors("rgbObject").a<=1&&o&&a.opacity?"rgba("+o.r+", "+o.g+", "+o.b+", "+parseFloat(i)+")":"rgb("+o.r+", "+o.g+", "+o.b+")"):C(e=E(e)?D(e):e,a.letterCase),t.val(e),n.find("span").css({backgroundColor:e,opacity:i}),M(t,e,i)}function f(t,e){let i,o,s,a,n,r,c,l,h,d,f=t.parent(),p=t.data("tfminicolors-settings"),m=f.find(".tfminicolors-input-swatch"),u=f.find(".tfminicolors-grid"),g=f.find(".tfminicolors-slider"),w=f.find(".tfminicolors-opacity-slider"),b=u.find("[class$=-picker]"),y=g.find("[class$=-picker]"),v=w.find("[class$=-picker]");switch(E(t.val())?(i=D(t.val()),(n=N(parseFloat(I(t.val())).toFixed(2),0,1))&&t.attr("data-opacity",n)):i=C(k(t.val(),!0),p.letterCase),o=function(t){const e=function(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),i=o-i;e.b=o,e.s=0!==o?255*i/o:0,0!==e.s?t.r===o?e.h=(t.g-t.b)/i:t.g===o?e.h=2+(t.b-t.r)/i:e.h=4+(t.r-t.g)/i:e.h=-1;e.h*=60,e.h<0&&(e.h+=360);return e.s*=100/255,e.b*=100/255,e}(F(t));0===e.s&&(e.h=360);return e}(i=i||C(x(p.defaultValue,!0),p.letterCase)),a=p.keywords?$.map(p.keywords.split(","),function(t){return $.trim(t.toLowerCase())}):[],r=""!==t.val()&&-1<$.inArray(t.val().toLowerCase(),a)?C(t.val()):E(t.val())?_(t.val()):i,e||t.val(r),p.opacity&&(s=""===t.attr("data-opacity")?1:N(parseFloat(t.attr("data-opacity")).toFixed(2),0,1),isNaN(s)&&(s=1),t.attr("data-opacity",s),m.find("span").css("opacity",s),l=N(w.height()-w.height()*s,0,w.height()),v.css("top",l+"px")),"transparent"===t.val().toLowerCase()&&m.find("span").css("opacity",0),m.find("span").css("backgroundColor",i),p.control){case"wheel":h=N(Math.ceil(.75*o.s),0,u.height()/2),d=o.h*Math.PI/180,c=N(75-Math.cos(d)*h,0,u.width()),l=N(75-Math.sin(d)*h,0,u.height()),b.css({top:l+"px",left:c+"px"}),l=150-o.b/100*u.height(),""===i&&(l=0),y.css("top",l+"px"),g.css("backgroundColor",j({h:o.h,s:o.s,b:100}));break;case"saturation":c=N(5/12*o.h,0,150),l=N(u.height()-Math.ceil(o.b/100*u.height()),0,u.height()),b.css({top:l+"px",left:c+"px"}),l=N(g.height()-o.s*g.height()/100,0,g.height()),y.css("top",l+"px"),g.css("backgroundColor",j({h:o.h,s:100,b:o.b})),f.find(".tfminicolors-grid-inner").css("opacity",o.s/100);break;case"brightness":c=N(5/12*o.h,0,150),l=N(u.height()-Math.ceil(o.s/100*u.height()),0,u.height()),b.css({top:l+"px",left:c+"px"}),l=N(g.height()-o.b*g.height()/100,0,g.height()),y.css("top",l+"px"),g.css("backgroundColor",j({h:o.h,s:o.s,b:100})),f.find(".tfminicolors-grid-inner").css("opacity",1-o.b/100);break;default:c=N(Math.ceil(o.s/100*u.width()),0,u.width()),l=N(u.height()-Math.ceil(o.b/100*u.height()),0,u.height()),b.css({top:l+"px",left:c+"px"}),l=N(g.height()-o.h/360*g.height(),0,g.height()),y.css("top",l+"px"),u.css("backgroundColor",j({h:o.h,s:100,b:100}));break}t.data("tfminicolors-initialized")&&M(t,r,s)}function M(t,e,i){let o=t.data("tfminicolors-settings"),s=t.data("tfminicolors-lastChange"),a,n,r;if(!s||s.value!==e||s.opacity!==i){if(t.data("tfminicolors-lastChange",{value:e,opacity:i}),o.swatches&&0!==o.swatches.length){for(a=E(e)?_(e,!0):F(e),n=-1,r=0;r<o.swatches.length;++r)if(a.r===o.swatches[r].r&&a.g===o.swatches[r].g&&a.b===o.swatches[r].b&&a.a===o.swatches[r].a){n=r;break}t.parent().find(".tfminicolors-swatches .tfminicolors-swatch").removeClass("selected"),-1!==n&&t.parent().find(".tfminicolors-swatches .tfminicolors-swatch").eq(r).addClass("selected")}o.change&&(o.changeDelay?(clearTimeout(t.data("tfminicolors-changeTimeout")),t.data("tfminicolors-changeTimeout",setTimeout(function(){o.change.call(t.get(0),e,i)},o.changeDelay))):o.change.call(t.get(0),e,i)),t.trigger("change").trigger("input")}}function C(t,e){return"uppercase"===e?t.toUpperCase():t.toLowerCase()}function k(t,e){return!(t=t.replace(/^#/g,"")).match(/^[A-F0-9]{3,6}/gi)||3!==t.length&&6!==t.length?"":"#"+(t=3===t.length&&e?t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:t)}function _(t,e){t=t.replace(/[^\d,.]/g,"").split(",");return t[0]=N(parseInt(t[0],10),0,255),t[1]=N(parseInt(t[1],10),0,255),t[2]=N(parseInt(t[2],10),0,255),void 0!==t[3]&&(t[3]=N(parseFloat(t[3],10),0,1)),e?void 0!==t[3]?{r:t[0],g:t[1],b:t[2],a:t[3]}:{r:t[0],g:t[1],b:t[2]}:void 0!==t[3]&&t[3]<=1?"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")":"rgb("+t[0]+", "+t[1]+", "+t[2]+")"}function x(t,e){return E(t)?_(t):k(t,e)}function N(t,e,i){return t<e?t=e:i<t&&(t=i),t}function E(t){const e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length}function I(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===t.length?t[4]:"1"}function D(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""}function p(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return $.each(i,function(t,e){1===e.length&&(i[t]="0"+e)}),"#"+i.join("")}function j(t){return p(function(t){var e,i={},o=Math.round(t.h),s=Math.round(2.55*t.s),t=Math.round(2.55*t.b);return 0===s?i.r=i.g=i.b=t:(t=o%60*((e=t)-(s=(255-s)*t/255))/60,(o=360===o?0:o)<60?(i.r=e,i.b=s,i.g=s+t):o<120?(i.g=e,i.b=s,i.r=e-t):o<180?(i.g=e,i.r=s,i.b=s+t):o<240?(i.b=e,i.r=s,i.g=e-t):o<300?(i.b=e,i.g=s,i.r=s+t):o<360?(i.r=e,i.g=s,i.b=e-t):(i.r=0,i.g=0,i.b=0)),{r:Math.round(i.r),g:Math.round(i.g),b:Math.round(i.b)}}(t))}function F(t){return{r:(t=parseInt(-1<t.indexOf("#")?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}$.tfminicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom",show:null,showSpeed:100,theme:"default",swatches:[]}},$.extend($.fn,{tfminicolors:function(t,e){switch(t){case"destroy":return $(this).each(function(){i($(this))}),$(this);case"hide":return h(),$(this);case"opacity":return void 0===e?$(this).attr("data-opacity"):($(this).each(function(){f($(this).attr("data-opacity",e))}),$(this));case"rgbObject":return function(t){const e=$(t),i=e.attr("data-opacity"),o=e.val(),s=E(o)?_(o,!0):F(k(o,!0));if(!s)return null;void 0!==i&&$.extend(s,{a:parseFloat(i)});return s}($(this));case"rgbString":case"rgbaString":return function(t,e){const i=$(t),o=i.val(),s=E(o)?_(o,!0):F(k(o,!0));let a=i.attr("data-opacity");if(!s)return null;void 0===a&&(a=1);return e?"rgba("+s.r+", "+s.g+", "+s.b+", "+parseFloat(a)+")":"rgb("+s.r+", "+s.g+", "+s.b+")"}($(this),"rgbaString"===t);case"settings":return void 0===e?$(this).data("tfminicolors-settings"):($(this).each(function(){var t=$(this).data("tfminicolors-settings")||{};i($(this)),$(this).tfminicolors($.extend(!0,t,e))}),$(this));case"show":return l($(this).eq(0)),$(this);case"value":return void 0===e?$(this).val():($(this).each(function(){"object"==typeof e&&null!==e?(void 0!==e.opacity&&$(this).attr("data-opacity",N(e.opacity,0,1)),e.color&&$(this).val(e.color)):$(this).val(e),f($(this))}),$(this));default:return"create"!==t&&(e=t),$(this).each(function(){!function(a,e){var t,i,o,s,n,r=$('<div class="tfminicolors" />'),c=$.tfminicolors.defaults;if(!a.data("tfminicolors-initialized")){if(e=$.extend(!0,{},c,e),r.addClass("tfminicolors-theme-"+e.theme).addClass(e.opacity?"tfminicolors-with-opacity":"tfminicolors-without-opacity"),void 0!==e.position&&$.each(e.position.split(" "),function(){r.addClass("tfminicolors-position-"+this)}),c="rgb"===e.format?e.opacity?"25":"20":e.keywords?"11":"7",a.addClass("tfminicolors-input").data("tfminicolors-initialized",!1).data("tfminicolors-settings",e).prop("size",c).attr("autocomplete","off").wrap(r).after('<div class="tfminicolors-panel tfminicolors-slider-'+e.control+'"><div class="tfminicolors-slider tfminicolors-sprite"><div class="tfminicolors-picker"></div></div><div class="tfminicolors-opacity-slider tfminicolors-sprite"><div class="tfminicolors-picker"></div></div><div class="tfminicolors-grid tfminicolors-sprite"><div class="tfminicolors-grid-inner tf_abs tf_w tf_h"></div><div class="tfminicolors-picker"><div></div></div></div></div>'),e.inline||a.after('<span class="tfminicolors-swatch tfminicolors-sprite tfminicolors-input-swatch"><span class="tfminicolors-swatch-color tf_abs"></span></span>'),a.on("focus.tfminicolors blur.tfminicolors keydown.tfminicolors keyup.tfminicolors paste.tfminicolors",function(t){var e=t.type;if("focus"===e)l(a);else if("blur"===e){var i,o,s=a.data("tfminicolors-settings");a.data("tfminicolors-initialized")&&(o=s.keywords?$.map(s.keywords.split(","),function(t){return $.trim(t.toLowerCase())}):[],o=""!==a.val()&&-1<$.inArray(a.val().toLowerCase(),o)?a.val():null===(o=E(a.val())?_(a.val(),!0):(o=k(a.val(),!0))?F(o):null)?s.defaultValue:"rgb"===s.format?s.opacity?_("rgba("+o.r+","+o.g+","+o.b+","+a.attr("data-opacity")+")"):_("rgb("+o.r+","+o.g+","+o.b+")"):p(o),i=s.opacity?a.attr("data-opacity"):1,"transparent"===o.toLowerCase()&&(i=0),a.closest(".tfminicolors").find(".tfminicolors-input-swatch > span").css("opacity",i),a.val(o),""===a.val()&&a.val(x(s.defaultValue,!0)),a.val(C(a.val(),s.letterCase)))}else if("keydown"===e)switch(t.which){case 9:h();break;case 13:case 27:h(),a.blur();break}else"keyup"!==e&&"paste"!==e||("keyup"===e?f(a,!0):setTimeout(function(){f(a,!0)},1))}).closest(".tfminicolors").on("mousedown.tfminicolors touchstart.tfminicolors",".tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider",function(t){if(1===t.which){t.preventDefault();const e=$(this),i=document.body.contains(this)?document:top.document;d(e,t,!0),$(i).on("mousemove.tfminicolors touchmove.tfminicolors",function(t){d(e,t)}).one("mouseup.tfminicolors touchend.tfminicolors",function(){$(i).off("mousemove.tfminicolors touchmove.tfminicolors")})}}).on("click.tfminicolors",".tfminicolors-swatches li",function(t){t.preventDefault();var t=$(this),e=t.parents(".tfminicolors").find(".tfminicolors-input"),t=t.data("swatch-color");S(e,t,I(t)),f(e)}).find(".tfminicolors-input-swatch").on("click mousedown.tfminicolors touchstart.tfminicolors",function(t){if("click"===t.type)e.inline||a.focus();else{if(1!==t.which)return;l(a)}t.preventDefault()}),(c=a.parent().find(".tfminicolors-panel")).on("selectstart",function(){return!1}).end(),e.swatches&&0!==e.swatches.length)for(c.addClass("tfminicolors-with-swatches"),i=$('<ul class="tfminicolors-swatches tf_scrollbar"></ul>').appendTo(c),n=0;n<e.swatches.length;++n)o="object"==typeof e.swatches[n]?(t=e.swatches[n].name,e.swatches[n].color):(t="",e.swatches[n]),o=E(s=o)?_(o,!0):F(k(o,!0)),$('<li class="tfminicolors-swatch tfminicolors-sprite"><span class="tfminicolors-swatch-color tf_abs" title="'+t+'"></span></li>').appendTo(i).data("swatch-color",s).find(".tfminicolors-swatch-color").css({backgroundColor:p(o),opacity:o.a}),e.swatches[n]=o;e.inline&&a.parent().addClass("tfminicolors-inline"),f(a,!1),a.data("tfminicolors-initialized",!0)}}($(this),e)}),$(this)}}})}(jQuery),function($,t,l){"use strict";t.themifyColorManager={colorSwatches:{},initilized:!1,init(){if(!this.initilized&&"undefined"!=typeof themifyCM){this.initilized=!0;for(let t=Object.keys(themifyCM.colors),e=0,i=t.length;e<i;++e)this.colorSwatches[t[e]]=themifyCM.colors[t[e]]}},toRgba(t){return t.color.replace("rgb","rgba").replace(")",","+t.opacity+")")},toColorsArray(){let i=[];for(let t=Object.keys(this.colorSwatches),e=t.length-1;-1<e;--e)i.push(this.toRgba(this.colorSwatches[t[e]]));return i=i.length?i:["#FFF"]},initColorPicker(t){const e=t.closest(".tfminicolors").querySelector(".tfminicolors-focus .tfminicolors-panel");if(!e.getElementsByClassName("tf_swatches_container")[0]){const i=l.createElement("div"),o=i.getElementsByClassName("tfminicolors-swatch"),s=Object.keys(this.colorSwatches).reverse(),a=l.createElement("div"),n=l.createElement("span"),r=l.createElement("span"),c=l.createElement("div");i.className="tf_swatches_container",i.addEventListener("click",this.initClick.bind(this)),i.appendChild(e.getElementsByClassName("tfminicolors-swatches")[0]);for(let i=o.length-1;-1<i;--i){if(!s.length){o[i].parentNode.removeChild(o[i]);break}let t=l.createElement("span"),e=void 0!==this.colorSwatches[s[i]].uid?this.colorSwatches[s[i]].uid:this.UID()+i;t.className="tf_delete_swatch tf_close",o[i].appendChild(t),o[i].dataset.uid=this.colorSwatches[s[i]].uid=e}r.className=n.className="tf_cm_tooltip",n.innerText=themifyCM.labels.save,a.appendChild(n),a.className="tf_add_swatch tf_plus_icon",a.setAttribute("tabIndex","-1"),i.appendChild(a),r.innerText=themifyCM.labels.ie,c.appendChild(r),c.className="tf_cm_dropdown_icon",c.appendChild(this.getIcon("ti-import")),c.setAttribute("tabIndex","-1"),c.appendChild(this.makeImportExportDropdown()),i.appendChild(c),e.appendChild(i)}},makeImportExportDropdown(){const t=l.createElement("div"),e=l.createElement("ul"),i=l.createElement("li"),o=l.createElement("li");return t.className="tf_cm_dropdown",i.className="tb_cm_import",i.textContent=themifyCM.labels.import,i.appendChild(this.getIcon("ti-import")),e.appendChild(i),o.className="tb_cm_export",o.textContent=themifyCM.labels.export,o.appendChild(this.getIcon("ti-export")),e.appendChild(o),t.appendChild(e),t},getIcon(t,e){t="tf-"+t.trim().replace(" ","-");const i="http://www.w3.org/2000/svg",o=l.createElementNS(i,"use"),s=l.createElementNS(i,"svg");let a="tf_fa "+t;return e&&(a+=" "+e),s.setAttribute("class",a),o.setAttributeNS(null,"href","#"+t),s.appendChild(o),s},UID(){const t=Math.random().toString(36).substring(2)+(new Date).getTime().toString(36);return t.substring(0,5)},initClick(t){t.preventDefault();const e=t.target,i=e.classList;i.contains("tf_delete_swatch")?this.deleteSwatch(t):i.contains("tf_add_swatch")?this.addSwatch(e.ownerDocument):i.contains("tb_cm_export")?(e.parentNode.parentNode.parentNode.blur(),l.location.assign(themifyCM.exportColorsURL)):i.contains("tb_cm_import")&&(e.parentNode.parentNode.parentNode.blur(),this.importColors("colors",e.ownerDocument))},importColors(t,a){let e=(a=a||l).getElementsByClassName("themify_cm_input")[0];if(e)e.dataset.type=t;else{(e=l.createElement("input")).type="file",e.dataset.type=t,e.className="themify_cm_input";const n=this;e.addEventListener("change",function(t){const e=t.target.files[0],i=new FormData,s=t.target.dataset.type;i.append("file",e,e.name),i.append("action","themify_import_colors"),i.append("tb_load_nonce",themifyCM.nonce),i.append("type",s),$.ajax({url:themifyCM.ajax_url,type:"POST",data:i,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(t){if("SUCCESS"===t.status)if("colors"===s){n.colorSwatches=t.colors;for(let t=a.querySelectorAll(".tf_swatches_container .tfminicolors-swatch"),e=t.length-1;-1<e;--e)t[e].parentNode.removeChild(t[e]);for(let t=Object.keys(n.colorSwatches),e=t.length,i=0;i<e;i++)n.addSwatchHtml(a,n.colorSwatches[t[i]].color,n.colorSwatches[t[i]].opacity,t[i])}else if("gradients"===s){const o=ThemifyBuilderCommon.Lightbox.$lightbox.find(".tb_gradient_container").first().data("themifyGradient");for(let t=Object.keys(themifyCM.gradients),e=t.length-1;-1<e;--e)o.removeSwatch(t[e]);themifyCM.gradients=t.colors;for(let t=Object.keys(themifyCM.gradients),e=0,i=t.length;e<i;++e)o.addSwatch(themifyCM.gradients[t[e]])}alert(t.msg)}})})}e.click()},deleteSwatch(i){i.preventDefault(),i.stopPropagation();const o=i.target.parentNode.dataset.uid;for(let t=i.target.ownerDocument.querySelectorAll('[data-uid="'+o+'"]'),e=t.length-1;-1<e;--e)t[e].parentNode.removeChild(t[e]);delete this.colorSwatches[o],this.updateColorSwatches("colors")},updateColorSwatches(t){$.ajax({type:"POST",url:themifyCM.ajax_url,dataType:"json",data:{action:"themify_save_colors",type:t,tb_load_nonce:themifyCM.nonce,colors:"colors"===t?this.colorSwatches:themifyCM.gradients}})},addSwatch(t){const e=t.querySelector(".tfminicolors-focus .tfminicolors-input"),i=this.hex2Rgb(e.value),o=e.dataset.opacity;if(null===i)return!1;for(let t=Object.keys(this.colorSwatches),e=t.length-1;-1<e;--e)if(this.colorSwatches[t[e]].color.replace(/\s/g,"")===i&&parseFloat(this.colorSwatches[t[e]].opacity)===parseFloat(o))return!1;const s=this.UID();this.addSwatchHtml(t,i,o,s),this.colorSwatches[s]={color:i,opacity:o,uid:s},this.updateColorSwatches("colors")},addSwatchHtml(i,s,a,o){for(let t=i.querySelectorAll(".tf_swatches_container .tfminicolors-swatches"),e=t.length-1;-1<e;--e)t[e].insertBefore(function(t){const e=l.createElement("li"),i=l.createElement("span"),o=l.createElement("span");return e.className="tfminicolors-swatch tfminicolors-sprite",e.dataset.uid=t,e.dataset.swatchColor=s.replace(")",", "+a+")").replace("rgb","rgba"),i.className="tfminicolors-swatch-color tf_abs",i.style.backgroundColor=s,i.style.opacity=a,e.appendChild(i),o.className="tf_delete_swatch tf_close",e.appendChild(o),e}(o),t[e].firstChild)},hex2Rgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?"rgb("+parseInt(e[1],16)+","+parseInt(e[2],16)+","+parseInt(e[3],16)+")":null}},t.themifyColorManager.init()}(jQuery,window,document);