(window.webpackWcBlocksJsonp=window.webpackWcBlocksJsonp||[]).push([[87],{108:function(e,t,c){"use strict";c.d(t,"c",(function(){return o})),c.d(t,"b",(function(){return r})),c.d(t,"a",(function(){return a})),c.d(t,"d",(function(){return i}));var s=c(26),n=c(71),l=c(129);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"filter_stock_status";const c=Object(n.d)(t);if(!c)return[];const l=Object(s.a)(c)?c.split(","):c,o=Object.keys(e);return l.filter(e=>o.includes(e))};function r(){return Math.floor(Math.random()*Date.now())}const a=e=>e.trim().replace(/\s/g,"").replace(/_/g,"-").replace(/-+/g,"-").replace(/[^a-zA-Z0-9-]/g,""),i=e=>({heading:Object(s.a)(null==e?void 0:e.heading)?e.heading:"",headingLevel:Object(s.a)(null==e?void 0:e.headingLevel)&&parseInt(e.headingLevel,10)||l.attributes.headingLevel.default,showFilterButton:"true"===(null==e?void 0:e.showFilterButton),showCounts:"false"!==(null==e?void 0:e.showCounts),isPreview:!1,displayStyle:Object(s.a)(null==e?void 0:e.displayStyle)&&e.displayStyle||l.attributes.displayStyle.default,selectType:Object(s.a)(null==e?void 0:e.selectType)&&e.selectType||l.attributes.selectType.default})},129:function(e){e.exports=JSON.parse('{"name":"woocommerce/stock-filter","version":"1.0.0","title":"Filter by Stock Controls","description":"Enable customers to filter the product grid by stock status.","category":"woocommerce","keywords":["WooCommerce"],"supports":{"html":false,"multiple":false,"color":true,"inserter":false,"lock":false},"attributes":{"className":{"type":"string","default":""},"headingLevel":{"type":"number","default":3},"showCounts":{"type":"boolean","default":true},"showFilterButton":{"type":"boolean","default":false},"displayStyle":{"type":"string","default":"list"},"selectType":{"type":"string","default":"multiple"},"isPreview":{"type":"boolean","default":false}},"textdomain":"woo-gutenberg-products-block","apiVersion":2,"$schema":"https://schemas.wp.org/trunk/block.json"}')},131:function(e,t){},158:function(e,t,c){"use strict";var s=c(0),n=c(1),l=c(29),o=c(80),r=c(150),a=c(148),i=c(27),u=c(56),b=c(31),d=c(135),f=c(2),O=c(81),m=c(64),j=c(63),g=c(62),p=c(55),k=c(82),w=c(14),v=c.n(w),h=c(22),y=c(74),_=c(20),E=c(15),S=c(71),C=c(4),N=c.n(C);const L=[{value:"preview-1",name:"In Stock",label:Object(s.createElement)(p.a,{name:"In Stock",count:3}),textLabel:"In Stock (3)"},{value:"preview-2",name:"Out of stock",label:Object(s.createElement)(p.a,{name:"Out of stock",count:3}),textLabel:"Out of stock (3)"},{value:"preview-3",name:"On backorder",label:Object(s.createElement)(p.a,{name:"On backorder",count:2}),textLabel:"On backorder (2)"}];c(228);var F=c(108),A=c(44);const x=S.a+"stock_status";t.a=e=>{let{attributes:t,isEditor:c=!1}=e;const w=Object(A.b)(),C=Object(f.getSettingWithCoercion)("is_rendering_php_template",!1,y.a),[P,B]=Object(s.useState)(!1),{outofstock:I,...R}=Object(f.getSetting)("stockStatusOptions",{}),T=c?[]:Object(f.getSettingWithCoercion)("product_ids",[],Array.isArray),W=Object(s.useRef)(Object(f.getSetting)("hideOutOfStockItems",!1)?R:{outofstock:I,...R}),M=Object(s.useMemo)(()=>Object(F.c)(W.current,x),[]),[J,$]=Object(s.useState)(M),[q,z]=Object(s.useState)(t.isPreview?L:[]),[D]=Object(s.useState)(Object.entries(W.current).map(e=>{let[t,c]=e;return{slug:t,name:c}}).filter(e=>!!e.name).sort((e,t)=>e.slug.localeCompare(t.slug))),[Q]=Object(b.a)(),[U,V]=Object(b.b)("stock_status",M),{results:Z,isLoading:G}=Object(d.a)({queryStock:!0,queryState:Q,productIds:T,isEditor:c}),H=Object(s.useCallback)(e=>Object(_.b)(Z,"stock_status_counts")&&Array.isArray(Z.stock_status_counts)?Z.stock_status_counts.find(t=>{let{status:c,count:s}=t;return c===e&&0!==Number(s)}):null,[Z]),[K,X]=Object(s.useState)(Object(F.b)()),Y=Object(a.a)(t);Object(s.useEffect)(()=>{if(G||t.isPreview)return;const e=D.map(e=>{const c=H(e.slug);if(!(c||J.includes(e.slug)||(n=e.slug,null!=Q&&Q.stock_status&&Q.stock_status.some(e=>{let{status:t=[]}=e;return t.includes(n)}))))return null;var n;const l=c?Number(c.count):0;return{value:e.slug,name:Object(h.decodeEntities)(e.name),label:Object(s.createElement)(p.a,{name:Object(h.decodeEntities)(e.name),count:t.showCounts?l:null}),textLabel:t.showCounts?`${Object(h.decodeEntities)(e.name)} (${l})`:Object(h.decodeEntities)(e.name)}}).filter(e=>!!e);z(e),X(Object(F.b)())},[t.showCounts,t.isPreview,G,H,J,Q.stock_status,D]);const ee="single"!==t.selectType,te=Object(s.useCallback)(e=>{c||(e&&!C&&V(e),(e=>{if(!window)return;if(0===e.length){const e=Object(E.removeQueryArgs)(window.location.href,x);return void(e!==Object(S.e)(window.location.href)&&Object(S.c)(e))}const t=Object(E.addQueryArgs)(window.location.href,{[x]:e.join(",")});t!==Object(S.e)(window.location.href)&&Object(S.c)(t)})(e))},[c,V,C]);Object(s.useEffect)(()=>{t.showFilterButton||te(J)},[t.showFilterButton,J,te]);const ce=Object(s.useMemo)(()=>U,[U]),se=Object(i.a)(ce),ne=Object(u.a)(se);Object(s.useEffect)(()=>{v()(ne,se)||v()(J,se)||$(se)},[J,se,ne]),Object(s.useEffect)(()=>{P||(V(M),B(!0))},[V,P,B,M]);const le=Object(s.useCallback)(e=>{const t=e=>{const t=q.find(t=>t.value===e);return t?t.name:null},c=e=>{let{filterAdded:c,filterRemoved:s}=e;const o=c?t(c):null,r=s?t(s):null;o?Object(l.speak)(Object(n.sprintf)(
/* translators: %s stock statuses (for example: 'instock'...) */
Object(n.__)("%s filter added.","woo-gutenberg-products-block"),o)):r&&Object(l.speak)(Object(n.sprintf)(
/* translators: %s stock statuses (for example:'instock'...) */
Object(n.__)("%s filter removed.","woo-gutenberg-products-block"),r))},s=J.includes(e);if(!ee){const t=s?[]:[e];return c(s?{filterRemoved:e}:{filterAdded:e}),void $(t)}if(s){const t=J.filter(t=>t!==e);return c({filterRemoved:e}),void $(t)}const o=[...J,e].sort();c({filterAdded:e}),$(o)},[J,ee,q]);if(!G&&0===q.length)return w(!1),null;const oe="h"+t.headingLevel,re=!t.isPreview&&!W.current||0===q.length,ae=!t.isPreview&&G;if(!Object(f.getSettingWithCoercion)("has_filterable_products",!1,y.a))return w(!1),null;const ie=ee?!re&&J.length<q.length:!re&&0===J.length,ue=Object(s.createElement)(oe,{className:"wc-block-stock-filter__title"},t.heading),be=re?Object(s.createElement)(g.a,null,ue):ue;return w(!0),Object(s.createElement)(s.Fragment,null,!c&&t.heading&&be,Object(s.createElement)("div",{className:N()("wc-block-stock-filter","style-"+t.displayStyle,{"is-loading":re})},"dropdown"===t.displayStyle?Object(s.createElement)(s.Fragment,null,Object(s.createElement)(k.a,{key:K,className:N()(Y.className,{"single-selection":!ee,"is-loading":re}),style:{...Y.style},suggestions:q.filter(e=>!J.includes(e.value)).map(e=>e.value),disabled:re,placeholder:Object(n.__)("Select stock status","woo-gutenberg-products-block"),onChange:e=>{!ee&&e.length>1&&(e=e.slice(-1));const t=[e=e.map(e=>{const t=q.find(t=>t.value===e);return t?t.value:e}),J].reduce((e,t)=>e.filter(e=>!t.includes(e)));if(1===t.length)return le(t[0]);const c=[J,e].reduce((e,t)=>e.filter(e=>!t.includes(e)));1===c.length&&le(c[0])},value:J,displayTransform:e=>{const t=q.find(t=>t.value===e);return t?t.textLabel:e},saveTransform:F.a,messages:{added:Object(n.__)("Stock filter added.","woo-gutenberg-products-block"),removed:Object(n.__)("Stock filter removed.","woo-gutenberg-products-block"),remove:Object(n.__)("Remove stock filter.","woo-gutenberg-products-block"),__experimentalInvalid:Object(n.__)("Invalid stock filter.","woo-gutenberg-products-block")}}),ie&&Object(s.createElement)(o.a,{icon:r.a,size:30})):Object(s.createElement)(O.a,{className:"wc-block-stock-filter-list",options:q,checked:J,onChange:le,isLoading:re,isDisabled:ae})),Object(s.createElement)("div",{className:"wc-block-stock-filter__actions"},(J.length>0||c)&&!re&&Object(s.createElement)(j.a,{onClick:()=>{$([]),te([])},screenReaderLabel:Object(n.__)("Reset stock filter","woo-gutenberg-products-block")}),t.showFilterButton&&Object(s.createElement)(m.a,{className:"wc-block-stock-filter__button",isLoading:re,disabled:re||ae,onClick:()=>te(J)})))}},228:function(e,t){},281:function(e,t,c){"use strict";c.d(t,"a",(function(){return o}));var s=c(57),n=c(20),l=c(114);const o=e=>{const t=Object(n.a)(e)?e:{},c=Object(l.a)(t.style);return Object(s.__experimentalUseColorProps)({...t,style:c})}},487:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(281),l=c(26),o=c(158),r=c(108);t.default=e=>{const t=Object(n.a)(e);return Object(s.createElement)("div",{className:Object(l.a)(e.className)?e.className:"",style:{...t.style}},Object(s.createElement)(o.a,{isEditor:!1,attributes:Object(r.d)(e)}))}},55:function(e,t,c){"use strict";var s=c(0),n=c(1),l=c(21);c(131),t.a=e=>{let{name:t,count:c}=e;return Object(s.createElement)(s.Fragment,null,t,null!==c&&Number.isFinite(c)&&Object(s.createElement)(l.a,{label:c.toString(),screenReaderLabel:Object(n.sprintf)(
/* translators: %s number of products. */
Object(n._n)("%s product","%s products",c,"woo-gutenberg-products-block"),c),wrapperElement:"span",wrapperProps:{className:"wc-filter-element-label-list-count"}}))}},62:function(e,t,c){"use strict";var s=c(0);c(87),t.a=e=>{let{children:t}=e;return Object(s.createElement)("div",{className:"wc-block-filter-title-placeholder"},t)}},87:function(e,t){}}]);