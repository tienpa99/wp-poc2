(window.webpackWcBlocksJsonp=window.webpackWcBlocksJsonp||[]).push([[84],{107:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return i}));var r=n(26),c=n(71),a=n(141);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"filter_rating";const t=Object(c.d)(e);if(!t)return[];const n=Object(r.a)(t)?t.split(","):t;return n};function o(){return Math.floor(Math.random()*Date.now())}const s=e=>e.trim().replace(/\s/g,"-").replace(/_/g,"-").replace(/-+/g,"-").replace(/[^a-zA-Z0-9-]/g,""),i=e=>({showFilterButton:"true"===(null==e?void 0:e.showFilterButton),showCounts:"false"!==(null==e?void 0:e.showCounts),isPreview:!1,displayStyle:Object(r.a)(null==e?void 0:e.displayStyle)&&e.displayStyle||a.attributes.displayStyle.default,selectType:Object(r.a)(null==e?void 0:e.selectType)&&e.selectType||a.attributes.selectType.default})},141:function(e){e.exports=JSON.parse('{"name":"woocommerce/rating-filter","version":"1.0.0","title":"Filter by Rating Controls","description":"Enable customers to filter the product grid by rating.","category":"woocommerce","keywords":["WooCommerce"],"supports":{"html":false,"multiple":false,"color":true,"inserter":false,"lock":false},"attributes":{"className":{"type":"string","default":""},"showCounts":{"type":"boolean","default":true},"displayStyle":{"type":"string","default":"list"},"showFilterButton":{"type":"boolean","default":false},"selectType":{"type":"string","default":"multiple"},"isPreview":{"type":"boolean","default":false}},"textdomain":"woo-gutenberg-products-block","apiVersion":2,"$schema":"https://schemas.wp.org/trunk/block.json"}')},157:function(e,t,n){"use strict";var r=n(0),c=n(1),a=n(29),l=n(80),o=n(150),s=n(4),i=n.n(s),u=e=>{let{className:t,rating:n,ratedProductsCount:a}=e;const l=i()("wc-block-components-product-rating",t),o={width:n/5*100+"%"},s=Object(c.sprintf)(
/* translators: %f is referring to the average rating value */
Object(c.__)("Rated %f out of 5","woo-gutenberg-products-block"),n),u={__html:Object(c.sprintf)(
/* translators: %s is the rating value wrapped in HTML strong tags. */
Object(c.__)("Rated %s out of 5","woo-gutenberg-products-block"),Object(c.sprintf)('<strong class="rating">%f</strong>',n))};return Object(r.createElement)("div",{className:l},Object(r.createElement)("div",{className:"wc-block-components-product-rating__stars",role:"img","aria-label":s},Object(r.createElement)("span",{style:o,dangerouslySetInnerHTML:u})),null!==a?Object(r.createElement)("span",{className:"wc-block-components-product-rating-count"},"(",a,")"):null)},b=n(148),d=n(27),g=n(56),f=n(31),j=n(135),O=n(2),m=n(74),p=n(20),w=n(14),v=n.n(w),y=n(81),h=n(64),_=n(63),k=n(82),E=n(15),C=n(71);const N=[{label:Object(r.createElement)(u,{className:"",key:5,rating:5,ratedProductsCount:5}),value:"5"},{label:Object(r.createElement)(u,{className:"",key:4,rating:4,ratedProductsCount:4}),value:"4"},{label:Object(r.createElement)(u,{className:"",key:3,rating:3,ratedProductsCount:3}),value:"3"},{label:Object(r.createElement)(u,{className:"",key:2,rating:2,ratedProductsCount:2}),value:"2"},{label:Object(r.createElement)(u,{className:"",key:1,rating:1,ratedProductsCount:1}),value:"1"}];n(227);var S=n(107),P=n(44);const R=e=>Object(c.sprintf)(
/* translators: %s is referring to the average rating value */
Object(c.__)("Rated %s out of 5 filter added.","woo-gutenberg-products-block"),e),F=e=>Object(c.sprintf)(
/* translators: %s is referring to the average rating value */
Object(c.__)("Rated %s out of 5 filter added.","woo-gutenberg-products-block"),e);t.a=e=>{let{attributes:t,isEditor:n,noRatingsNotice:s=null}=e;const w=Object(P.b)(),T=Object(O.getSettingWithCoercion)("is_rendering_php_template",!1,m.a),[B,L]=Object(r.useState)(!1),[A]=Object(f.a)(),{results:M,isLoading:W}=Object(j.a)({queryRating:!0,queryState:A,isEditor:n}),[x,I]=Object(r.useState)(t.isPreview?N:[]),J=!t.isPreview&&W&&0===x.length,q=!t.isPreview&&W,z=Object(r.useMemo)(()=>Object(S.c)("rating_filter"),[]),[D,Q]=Object(r.useState)(z),[H,U]=Object(f.b)("rating",z),[V,Z]=Object(r.useState)(Object(S.b)()),$=Object(b.a)(t),[G,K]=Object(r.useState)(!1),X="single"!==t.selectType,Y=X?!J&&D.length<x.length:!J&&0===D.length,ee=Object(r.useCallback)(e=>{n||(e&&!T&&U(e),(e=>{if(!window)return;if(0===e.length){const e=Object(E.removeQueryArgs)(window.location.href,"rating_filter");return void(e!==Object(C.e)(window.location.href)&&Object(C.c)(e))}const t=Object(E.addQueryArgs)(window.location.href,{rating_filter:e.join(",")});t!==Object(C.e)(window.location.href)&&Object(C.c)(t)})(e))},[n,U,T]);Object(r.useEffect)(()=>{t.showFilterButton||ee(D)},[t.showFilterButton,D,ee]);const te=Object(r.useMemo)(()=>H,[H]),ne=Object(d.a)(te),re=Object(g.a)(ne);Object(r.useEffect)(()=>{v()(re,ne)||v()(D,ne)||Q(ne)},[D,ne,re]),Object(r.useEffect)(()=>{B||(U(z),L(!0))},[U,B,L,z]),Object(r.useEffect)(()=>{if(W||t.isPreview)return;const e=!W&&Object(p.b)(M,"rating_counts")&&Array.isArray(M.rating_counts)?[...M.rating_counts].reverse():[];if(n&&0===e.length)return I(N),void K(!0);const c=e.filter(e=>Object(p.a)(e)&&Object.keys(e).length>0).map(e=>{var n;return{label:Object(r.createElement)(u,{key:null==e?void 0:e.rating,rating:null==e?void 0:e.rating,ratedProductsCount:t.showCounts?null==e?void 0:e.count:null}),value:null==e||null===(n=e.rating)||void 0===n?void 0:n.toString()}});I(c),Z(Object(S.b)())},[t.showCounts,t.isPreview,M,W,H,n]);const ce=Object(r.useCallback)(e=>{const t=D.includes(e);if(!X){const n=t?[]:[e];return Object(a.speak)(t?F(e):R(e)),void Q(n)}if(t){const t=D.filter(t=>t!==e);return Object(a.speak)(F(e)),void Q(t)}const n=[...D,e].sort((e,t)=>Number(t)-Number(e));Object(a.speak)(R(e)),Q(n)},[D,X]);return(W||0!==x.length)&&Object(O.getSettingWithCoercion)("has_filterable_products",!1,m.a)?(w(!0),Object(r.createElement)(r.Fragment,null,G&&s,Object(r.createElement)("div",{className:i()("wc-block-rating-filter","style-"+t.displayStyle,{"is-loading":J})},"dropdown"===t.displayStyle?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.a,{key:V,className:i()($.className,{"single-selection":!X,"is-loading":J}),style:{...$.style,borderStyle:"none"},suggestions:x.filter(e=>!D.includes(e.value)).map(e=>e.value),disabled:J,placeholder:Object(c.__)("Select Rating","woo-gutenberg-products-block"),onChange:e=>{!X&&e.length>1&&(e=[e[e.length-1]]);const t=[e=e.map(e=>{const t=x.find(t=>t.value===e);return t?t.value:e}),D].reduce((e,t)=>e.filter(e=>!t.includes(e)));if(1===t.length)return ce(t[0]);const n=[D,e].reduce((e,t)=>e.filter(e=>!t.includes(e)));1===n.length&&ce(n[0])},value:D,displayTransform:e=>{const t={value:e,label:Object(r.createElement)(u,{key:Number(e),rating:Number(e),ratedProductsCount:0})},n=x.find(t=>t.value===e)||t,{label:c,value:a}=n;return Object.assign({},c,{toLocaleLowerCase:()=>a,substring:(e,t)=>0===e&&1===t?c:""})},saveTransform:S.a,messages:{added:Object(c.__)("Rating filter added.","woo-gutenberg-products-block"),removed:Object(c.__)("Rating filter removed.","woo-gutenberg-products-block"),remove:Object(c.__)("Remove rating filter.","woo-gutenberg-products-block"),__experimentalInvalid:Object(c.__)("Invalid rating filter.","woo-gutenberg-products-block")}}),Y&&Object(r.createElement)(l.a,{icon:o.a,size:30})):Object(r.createElement)(y.a,{className:"wc-block-rating-filter-list",options:x,checked:D,onChange:e=>{ce(e.toString())},isLoading:J,isDisabled:q})),Object(r.createElement)("div",{className:"wc-block-rating-filter__actions"},(D.length>0||n)&&!J&&Object(r.createElement)(_.a,{onClick:()=>{Q([]),U([]),ee([])},screenReaderLabel:Object(c.__)("Reset rating filter","woo-gutenberg-products-block")}),t.showFilterButton&&Object(r.createElement)(h.a,{className:"wc-block-rating-filter__button",isLoading:J,disabled:J||q,onClick:()=>ee(D)})))):(w(!1),null)}},227:function(e,t){},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(57),c=n(20),a=n(114);const l=e=>{const t=Object(c.a)(e)?e:{},n=Object(a.a)(t.style);return Object(r.__experimentalUseColorProps)({...t,style:n})}},489:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(281),a=n(26),l=n(157),o=n(107);t.default=e=>{const t=Object(c.a)(e);return Object(r.createElement)("div",{className:Object(a.a)(e.className)?e.className:"",style:{...t.style}},Object(r.createElement)(l.a,{isEditor:!1,attributes:Object(o.d)(e)}))}}}]);