!function(){var e={875:function(e,t){var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var l=typeof r;if("string"===l||"number"===l)e.push(r);else if(Array.isArray(r)){if(r.length){var a=n.apply(null,r);a&&e.push(a)}}else if("object"===l){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var i in r)o.call(r,i)&&r[i]&&e.push(i)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},202:function(e){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var o,n,l;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(n=o;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t instanceof Map&&r instanceof Map){if(t.size!==r.size)return!1;for(n of t.entries())if(!r.has(n[0]))return!1;for(n of t.entries())if(!e(n[1],r.get(n[0])))return!1;return!0}if(t instanceof Set&&r instanceof Set){if(t.size!==r.size)return!1;for(n of t.entries())if(!r.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)){if((o=t.length)!=r.length)return!1;for(n=o;0!=n--;)if(t[n]!==r[n])return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(l=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=o;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,l[n]))return!1;for(n=o;0!=n--;){var a=l[n];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,r),l.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.React,o=r(875),n=r.n(o),l=window.wp.components,a=window.lodash;const i=(e,t)=>(0,a.mapKeys)({backgroundColor:e.backgroundColor||"#ffffff",buttonColor:e.buttonColor||t.accentColor,buttonTextColor:e.buttonTextColor||t.textColorInverted,textColor:e.textColor||t.textColor,textSize:t.textSize,triggerBackgroundColor:e.triggerBackgroundColor||t.accentColor,triggerTextColor:e.triggerTextColor||t.textColorInverted},((e,t)=>`--crowdsignal-forms-${(0,a.kebabCase)(t)}`));function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},s.apply(this,arguments)}var c=r(202),d=r.n(c),u=window.wp.compose;const f=e=>{let t=window.getComputedStyle(e).backgroundColor;for(;"rgba(0, 0, 0, 0)"===t&&e.parentNode&&e.parentNode.nodeType===window.Node.ELEMENT_NODE;)e=e.parentNode,t=window.getComputedStyle(e).backgroundColor;return t},g=()=>(0,e.createElement)("div",{className:"crowdsignal-forms__style-probe"},(0,e.createElement)("p",null),(0,e.createElement)("h3",null,"Text"),(0,e.createElement)("div",{className:"wp-block-button"},(0,e.createElement)("div",{className:"wp-block-button__link"})),(0,e.createElement)("div",{className:"entry-content"},(0,e.createElement)("div",{className:"alignwide"}))),m=e=>{if(null===e)return{};const t=e.querySelector(".wp-block-button__link"),r=e.querySelector("p"),o=e.querySelector("h3"),n=e.querySelector(".alignwide");let l=f(t);const a=f(r),i=window.getComputedStyle(r).color;if(l===a){l=(s=t,"0px"!==window.getComputedStyle(s).borderBlockStartWidth?window.getComputedStyle(s).borderBlockStartColor:null)||i}var s;return{accentColor:l,backgroundColor:a,textColor:i,textColorInverted:window.getComputedStyle(t).color,textFont:window.getComputedStyle(r).fontFamily,textSize:window.getComputedStyle(r).fontSize,headingFont:window.getComputedStyle(o).fontFamily,contentWideWidth:window.getComputedStyle(n).maxWidth}};var p=window.wp.htmlEntities,b=window.wp.i18n,w=()=>(0,e.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M17.7049 7.70504L16.2949 6.29504L11.9999 10.59L7.70492 6.29504L6.29492 7.70504L10.5899 12L6.29492 16.295L7.70492 17.705L11.9999 13.41L16.2949 17.705L17.7049 16.295L13.4099 12L17.7049 7.70504Z"}));const h="question",y="submit",v=(Object.freeze({OPEN:"open",CLOSED:"closed",CLOSED_AFTER:"closed-after"}),Object.freeze({CLICK:"click",HOVER:"hover",PAGE_LOAD:"load"}));var k=(0,t.forwardRef)(((r,o)=>{let{attributes:l,className:a,isOpen:i,onClick:s,onToggle:c}=r;(0,t.useLayoutEffect)(c,[i]),(0,t.useEffect)((()=>{i||l.toggleOn!==v.PAGE_LOAD||s()}),[]);const d=(0,t.useCallback)((()=>{i||l.toggleOn!==v.HOVER||s()}),[l.toggleOn,i]),u=n()("crowdsignal-forms-feedback__trigger","wp-block-button__link",a,{"is-active":i});return(0,e.createElement)("div",{className:"wp-block-button crowdsignal-forms-feedback__trigger-wrapper"},!i&&(0,e.createElement)("button",{ref:o,className:u,onClick:s,onMouseEnter:d},(0,e.createElement)("div",{className:"crowdsignal-forms-feedback__trigger-text"},(0,p.decodeEntities)(l.triggerLabel))),i&&(0,e.createElement)("button",{ref:o,className:u,onClick:s},(0,e.createElement)(w,null),(0,b.__)("Close","crowdsignal-forms")))})),E=window.crowdsignalForms.apiFetch,S=r.n(E);var C=r=>{let{attributes:o,onSubmit:l}=r;const[i,s]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[u,f]=(0,t.useState)({}),g=n()("crowdsignal-forms-feedback__input",{"is-error":u.feedback}),m=n()("crowdsignal-forms-feedback__input",{"is-error":u.email});return(0,e.createElement)("form",{onSubmit:async e=>{e.preventDefault();const t={feedback:(0,a.isEmpty)(i),email:o.emailRequired&&((0,a.isEmpty)(c)||c.match(/^\s+@\s+$/))};var r,n,s;f(t),t.feedback||t.email||(r=o.surveyId,n={nonce:o.nonce,feedback:i,email:c},s=S()({path:(0,a.trimEnd)(`/crowdsignal-forms/v1/feedback/${r||""}/response`),method:"POST",data:n}),new Promise(((e,t)=>{const r=setTimeout((()=>t(new Error("Request timed out"))),1e4);s.then(e,t).finally((()=>clearTimeout(r)))})),l())}},(0,e.createElement)("h3",{className:"crowdsignal-forms-feedback__header",style:{whiteSpace:"pre-wrap"}},(0,p.decodeEntities)(o.header).split("<br>").join("\n")),(0,e.createElement)("textarea",{className:g,rows:6,placeholder:o.feedbackPlaceholder,value:i,onChange:e=>s(e.target.value)}),(0,e.createElement)("input",{type:"email",className:m,placeholder:o.emailPlaceholder,value:c,onChange:e=>d(e.target.value)}),(0,e.createElement)("div",{className:"wp-block-button crowdsignal-forms-feedback__button-wrapper"},(0,e.createElement)("button",{className:"wp-block-button__link crowdsignal-forms-feedback__feedback-button",type:"submit"},o.submitButtonLabel)))},_=t=>{let{attributes:r}=t;return(0,e.createElement)("h3",{className:"crowdsignal-forms-feedback__header",style:{whiteSpace:"pre-wrap"}},(0,p.decodeEntities)(r.submitText).split("<br>").join("\n"))},O=t=>{let{showLogo:r,children:o,message:n,trackRef:l="cs-forms-poll"}=t;return(0,e.createElement)("div",{className:"crowdsignal-forms__footer-branding"},(0,e.createElement)("a",{className:"crowdsignal-forms__footer-cs-link",href:"https://crowdsignal.com?ref="+l,target:"_blank",rel:"noopener noreferrer"},n||(0,b.__)("Create your own poll with Crowdsignal","crowdsignal-forms")),o,r&&(0,e.createElement)("a",{href:"https://crowdsignal.com?ref="+l,target:"_blank",rel:"noopener noreferrer"},(0,e.createElement)("img",{className:"crowdsignal-forms__footer-branding-logo",src:"https://app.crowdsignal.com/images/svg/cs-logo-dots.svg",alt:"Crowdsignal sticker"})))},x=r=>{let{attributes:o}=r;const[n,l]=(0,t.useState)(h),[a,i]=(0,t.useState)("auto"),s=(0,t.useRef)(null),c={height:a};return(0,e.createElement)("div",{ref:s,className:"crowdsignal-forms-feedback__popover",style:c},n===h&&(0,e.createElement)(C,{attributes:o,onSubmit:()=>{i(s.current.offsetHeight),l(y)}}),n===y&&(0,e.createElement)(_,{attributes:o}),!o.hideBranding&&(0,e.createElement)(O,{trackRef:"cs-forms-feedback",showLogo:n===y,message:(0,b.__)("Collect your own feedback with Crowdsignal","crowdsignal-forms")}))};const N=(e,t,r)=>({left:"left"===e?r.left:null,right:"right"===e?r.right:null}),L=(e,t,r)=>"center"===e?{top:(window.innerHeight-t)/2,bottom:null}:{top:"top"===e?r.top:null,bottom:"bottom"===e?r.bottom:null};var j,R,T=(j=r=>{let{attributes:o,fallbackStyles:s,renderStyleProbe:c}=r;const[d,u]=(0,t.useState)({}),f=(0,t.useRef)(null),g=(0,t.useCallback)((()=>{u(((e,t,r,o)=>"center"!==t?e:{...e,left:null!==e.left?e.left-r+o:null,right:null!==e.right?e.right-r+o:null})(function(e,t,r,o,n){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i={left:(0,a.isObject)(n)?n.left:n,right:(0,a.isObject)(n)?n.right:n,top:(0,a.isObject)(n)?n.top:n,bottom:(0,a.isObject)(n)?n.bottom:n};return l&&(i=((e,t)=>({left:e.left+t.x+window.scrollX,right:e.right+(window.innerWidth>t.left+t.width?window.innerWidth-t.left-t.width:0),top:e.top+t.y+window.scrollY,bottom:e.bottom+(window.innerHeight>t.top+t.height?window.innerHeight-t.top-t.height:0)}))(i,l.getBoundingClientRect())),{...N(e,0,i),...L(t,o,i)}}(o.x,o.y,f.current.offsetWidth,"center"===o.y?f.current.offsetWidth:f.current.offsetHeight,{top:20,bottom:20,left:"center"===o.y?0:20,right:"center"===o.y?0:20},document.body),o.y,f.current.offsetWidth,f.current.offsetHeight))}),[o.x,o.y,f.current]);(0,t.useLayoutEffect)((()=>{g()}),[o.x,o.y,g]);const m=n()("crowdsignal-forms-feedback",`align-${o.x}`,{"no-shadow":o.hideTriggerShadow,"is-vertical":"center"===o.y}),p={...d,...i(o,s)};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:m,style:p},(0,e.createElement)(l.Dropdown,{popoverProps:{className:"crowdsignal-forms-feedback__popover-wrapper",position:(b=o.x,w=o.y,"center"!==w?"":"left"===b?"middle right":"middle left")},renderToggle:t=>{let{isOpen:r,onToggle:n}=t;return(0,e.createElement)(k,{ref:f,isOpen:r,onClick:n,onToggle:g,attributes:o})},renderContent:()=>(0,e.createElement)(x,{attributes:o})})),c());var b,w},(R=e=>({fallbackStyles:m(e.querySelector(".crowdsignal-forms__style-probe"))}),(0,u.createHigherOrderComponent)((t=>class extends e.Component{constructor(e){super(e),this.nodeRef=this.props.node,this.state={fallbackStyles:void 0,grabStylesCompleted:!1},this.bindRef=this.bindRef.bind(this)}bindRef(e){e&&(this.nodeRef=e)}componentDidMount(){this.grabFallbackStyles()}componentDidUpdate(){this.grabFallbackStyles()}grabFallbackStyles(){const{grabStylesCompleted:e,fallbackStyles:t}=this.state;if(this.nodeRef&&!e){const e=R(this.nodeRef,this.props);d()(e,t)||this.setState({fallbackStyles:e,grabStylesCompleted:Object.values(e).every(Boolean)})}}render(){const r=(0,e.createElement)(t,s({},this.props,this.state.fallbackStyles));return this.props.node?r:(0,e.createElement)("div",{ref:this.bindRef}," ",r," ")}}),"withFallbackStyles"))((t=>{let{fallbackStyles:r,...o}=t;return(0,e.createElement)(j,s({fallbackStyles:r||{},renderStyleProbe:()=>r?null:(0,e.createElement)(g,null)},o))}))),F=window.ReactDOM;const P=(e,t)=>(0,a.forEach)(document.querySelectorAll(`div[${e}]`),(r=>{try{const o=JSON.parse(r.dataset[(0,a.camelCase)(e.substr(5))]),n=t(o,r);r.removeAttribute(e),(0,F.render)(n,r)}catch(t){console.error("Crowdsignal Forms: Failed to parse block data for: %s",e)}})),M=(e,t)=>{((0,a.isEmpty)(window.CrowdsignalMutationObservers)||!0!==window.CrowdsignalMutationObservers[e])&&(new window.MutationObserver((()=>P(e,t))).observe(document.body,{attributes:!0,attributeFilter:[e],childList:!0,subtree:!0}),(0,a.isEmpty)(window.CrowdsignalMutationObservers)&&(window.CrowdsignalMutationObservers=[]),window.CrowdsignalMutationObservers[e]=!0,P(e,t))};((e,t)=>{if("complete"===document.readyState)return M(e,t);window.addEventListener("load",(()=>M(e,t)))})("data-crowdsignal-feedback",(t=>(0,e.createElement)(T,{attributes:t})))}()}();