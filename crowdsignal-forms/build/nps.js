!function(){var e={875:function(e,t){var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)){if(r.length){var s=o.apply(null,r);s&&e.push(s)}}else if("object"===a){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var l in r)n.call(r,l)&&r[l]&&e.push(l)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},202:function(e){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t instanceof Map&&r instanceof Map){if(t.size!==r.size)return!1;for(o of t.entries())if(!r.has(o[0]))return!1;for(o of t.entries())if(!e(o[1],r.get(o[0])))return!1;return!0}if(t instanceof Set&&r instanceof Set){if(t.size!==r.size)return!1;for(o of t.entries())if(!r.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(t[o]!==r[o])return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,a[o]))return!1;for(o=n;0!=o--;){var s=a[o];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.React,n=window.ReactDOM,o=window.lodash,a=r=>{let{children:n,onClose:o}=r;const a=(0,t.useRef)(null);return(0,e.createElement)("div",{ref:a,role:"dialog","aria-modal":"true",className:"crowdsignal-forms-dialog-wrapper",onClick:e=>e.target===a.current&&o()},n)},s=window.wp.htmlEntities,l=window.wp.i18n;const i="rating",c="feedback",u="submit",d=Object.freeze({OPEN:"open",CLOSED:"closed",CLOSED_AFTER:"closed-after"}),f=(e,t)=>(0,o.mapKeys)({backgroundColor:e.backgroundColor||"#ffffff",buttonColor:e.buttonColor||t.accentColor,buttonTextColor:e.buttonTextColor||t.textColorInverted,textColor:e.textColor||t.textColor,textSize:t.textSize},((e,t)=>`--crowdsignal-forms-${(0,o.kebabCase)(t)}`));var m=t=>{let{showLogo:r,children:n,message:o,trackRef:a="cs-forms-poll"}=t;return(0,e.createElement)("div",{className:"crowdsignal-forms__footer-branding"},(0,e.createElement)("a",{className:"crowdsignal-forms__footer-cs-link",href:"https://crowdsignal.com?ref="+a,target:"_blank",rel:"noopener noreferrer"},o||(0,l.__)("Create your own poll with Crowdsignal","crowdsignal-forms")),n,r&&(0,e.createElement)("a",{href:"https://crowdsignal.com?ref="+a,target:"_blank",rel:"noopener noreferrer"},(0,e.createElement)("img",{className:"crowdsignal-forms__footer-branding-logo",src:"https://app.crowdsignal.com/images/svg/cs-logo-dots.svg",alt:"Crowdsignal sticker"})))};function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}var g=r(202),b=r.n(g),w=window.wp.compose;const h=e=>{let t=window.getComputedStyle(e).backgroundColor;for(;"rgba(0, 0, 0, 0)"===t&&e.parentNode&&e.parentNode.nodeType===window.Node.ELEMENT_NODE;)e=e.parentNode,t=window.getComputedStyle(e).backgroundColor;return t},y=()=>(0,e.createElement)("div",{className:"crowdsignal-forms__style-probe"},(0,e.createElement)("p",null),(0,e.createElement)("h3",null,"Text"),(0,e.createElement)("div",{className:"wp-block-button"},(0,e.createElement)("div",{className:"wp-block-button__link"})),(0,e.createElement)("div",{className:"entry-content"},(0,e.createElement)("div",{className:"alignwide"}))),S=e=>{if(null===e)return{};const t=e.querySelector(".wp-block-button__link"),r=e.querySelector("p"),n=e.querySelector("h3"),o=e.querySelector(".alignwide");let a=h(t);const s=h(r),l=window.getComputedStyle(r).color;if(a===s){a=(i=t,"0px"!==window.getComputedStyle(i).borderBlockStartWidth?window.getComputedStyle(i).borderBlockStartColor:null)||l}var i;return{accentColor:a,backgroundColor:s,textColor:l,textColorInverted:window.getComputedStyle(t).color,textFont:window.getComputedStyle(r).fontFamily,textSize:window.getComputedStyle(r).fontSize,headingFont:window.getComputedStyle(n).fontFamily,contentWideWidth:window.getComputedStyle(o).maxWidth}};var v=window.crowdsignalForms.apiFetch,k=r.n(v);const E=(e,t)=>{return r=k()({path:(0,o.trimEnd)(`/crowdsignal-forms/v1/nps/${e||""}/response`),method:"POST",data:t}),new Promise(((e,t)=>{const n=setTimeout((()=>t(new Error("Request timed out"))),1e4);r.then(e,t).finally((()=>clearTimeout(n)))}));var r};var C,_,O=r=>{let{attributes:n,onSubmit:a,responseMeta:s}=r;const[l,i]=(0,t.useState)("");return(0,e.createElement)("div",{className:"crowdsignal-forms-nps__feedback"},(0,e.createElement)("textarea",{className:"crowdsignal-forms-nps__feedback-text",rows:6,placeholder:n.feedbackPlaceholder,onChange:e=>i(e.target.value),value:l}),(0,e.createElement)("div",{className:"wp-block-button crowdsignal-forms-nps__feedback-button-wrapper"},(0,e.createElement)("button",{className:"wp-block-button__link crowdsignal-forms-nps__feedback-button",onClick:async()=>{null===s||(0,o.isEmpty)(l)||E(n.surveyId,{nonce:n.nonce,feedback:l,...s}),a()},type:"button"},n.submitButtonLabel)))},N=r(875),x=r.n(N),R=r=>{let{attributes:n,onSubmit:a,onSubmitSuccess:s}=r;const[l,i]=(0,t.useState)(-1),c=e=>async()=>{i(e),E(n.surveyId,{nonce:n.nonce,score:e}).then((e=>s((0,o.pick)(e,["r","checksum"])))),setTimeout(a,300)};return(0,e.createElement)("div",{className:"crowdsignal-forms-nps__rating"},(0,e.createElement)("div",{className:"crowdsignal-forms-nps__rating-labels"},(0,e.createElement)("span",null,n.lowRatingLabel),(0,e.createElement)("span",null,n.highRatingLabel)),(0,e.createElement)("div",{className:"crowdsignal-forms-nps__rating-scale"},(0,o.times)(11,(t=>{const r=x()("crowdsignal-forms-nps__rating-button",{"is-active":t===l});return(0,e.createElement)("button",{key:`rating-${t}`,disabled:0<=l,className:r,onClick:c(t)},t)}))))},j=(C=r=>{let{attributes:n,contentWidth:a,fallbackStyles:d,onClose:p,renderStyleProbe:g}=r;const[b,w]=(0,t.useState)(null),[h,y]=(0,t.useState)(i),S=(0,o.get)({[c]:n.feedbackQuestion,[i]:n.ratingQuestion,[u]:(0,l.__)("Thanks so much for your feedback!","crowdsignal-forms")},[h]),v={width:`${a}px`,...f(n,d)};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"crowdsignal-forms-nps",style:v},(0,e.createElement)("h3",{className:"crowdsignal-forms-nps__question",style:{whiteSpace:"pre-wrap"}},(0,s.decodeEntities)(S).split("<br>").join("\n")),(0,e.createElement)("button",{className:"crowdsignal-forms-nps__close-button",onClick:p},"âœ•"),h===i&&(0,e.createElement)(R,{attributes:n,onSubmit:()=>y(c),onSubmitSuccess:w}),h===c&&(0,e.createElement)(O,{attributes:n,responseMeta:b,onSubmit:()=>y(u)}),!n.hideBranding&&(0,e.createElement)(m,{showLogo:h===u,message:(0,l.__)("Collect your own feedback with Crowdsignal","crowdsignal-forms"),trackRef:"cs-forms-nps"})),g())},(_=e=>({fallbackStyles:S(e.querySelector(".crowdsignal-forms__style-probe"))}),(0,w.createHigherOrderComponent)((t=>class extends e.Component{constructor(e){super(e),this.nodeRef=this.props.node,this.state={fallbackStyles:void 0,grabStylesCompleted:!1},this.bindRef=this.bindRef.bind(this)}bindRef(e){e&&(this.nodeRef=e)}componentDidMount(){this.grabFallbackStyles()}componentDidUpdate(){this.grabFallbackStyles()}grabFallbackStyles(){const{grabStylesCompleted:e,fallbackStyles:t}=this.state;if(this.nodeRef&&!e){const e=_(this.nodeRef,this.props);b()(e,t)||this.setState({fallbackStyles:e,grabStylesCompleted:Object.values(e).every(Boolean)})}}render(){const r=(0,e.createElement)(t,p({},this.props,this.state.fallbackStyles));return this.props.node?r:(0,e.createElement)("div",{ref:this.bindRef}," ",r," ")}}),"withFallbackStyles"))((t=>{let{fallbackStyles:r,...n}=t;return(0,e.createElement)(C,p({fallbackStyles:r||{},renderStyleProbe:()=>r?null:(0,e.createElement)(y,null)},n))})));window.addEventListener("load",(()=>(0,o.forEach)(document.querySelectorAll("div[data-crowdsignal-nps]"),(t=>{try{const r=JSON.parse(t.dataset.crowdsignalNps),o=parseInt(r.viewThreshold,10);if(t.removeAttribute("data-crowdsignal-nps"),d.CLOSED===r.status)return;if(d.CLOSED_AFTER===r.status&&null!==r.closedAfterDateTime&&(new Date).toISOString()>r.closedAfterDateTime)return;if(!r.isPreview){const e=`cs-nps-views-${r.surveyId}`,t=1+parseInt(window.localStorage.getItem(e)||0,10);if(window.localStorage.setItem(e,t),t!==o)return}const s=()=>t.remove();(0,n.render)((0,e.createElement)(a,{onClose:s},(0,e.createElement)(j,{attributes:r,contentWidth:t.scrollWidth,onClose:s})),t)}catch(e){console.error(e)}}))))}()}();