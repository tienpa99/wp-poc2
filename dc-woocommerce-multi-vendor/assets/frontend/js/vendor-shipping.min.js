!function($){if("undefined"==typeof mvx_vendor_shipping_script_data)return!1;var a=a||{build:function(){this.init(),this.bindEvents()},init:function(){this.modify_shipping_methods=".modify-shipping-methods",this.vendor_shipping_methods="#vendor-shipping-methods",this.shipping_by_zone_holder="#mvx_settings_form_shipping_by_zone",this.shipping_zone_table=this.shipping_by_zone_holder+" .shipping-zone-table",this.shipping_zone_list=".shipping-zone-list",this.shipping_method_manage_form="#mvx_shipping_method_manage_form",this.show_shipping_methods=this.vendor_shipping_methods+" .show-shipping-methods",this.add_shipping_methods=this.vendor_shipping_methods+" .add-shipping-method",this.edit_shipping_method=this.vendor_shipping_methods+" .edit-shipping-method",this.update_shipping_method=this.vendor_shipping_methods+" .update-shipping-method",this.delete_shipping_method=this.vendor_shipping_methods+" .delete-shipping-method",this.limit_zone_location=this.vendor_shipping_methods+" #limit_zone_location",this.method_status=this.vendor_shipping_methods+" .method-status",this.modal_close_link=".modal-close-link",this.modal_dialog=".mvx-modal-dialog"},bindEvents:function(){$(this.modify_shipping_methods).on("click",this.modifyShippingMethods.bind(this)),$(document).on("zone_settings_loaded",this.zoneLoadedEvents.bind(this)),$(document.body).on("change",".wc-shipping-zone-method-selector select",this.onChangeShippingMethodSelector),$(document).delegate(this.shipping_zone_list,"click",this.goToShippingZones.bind(this)),$(document).delegate(this.show_shipping_methods,"click",this.showShippingMethods.bind(this)),$(document).delegate(this.add_shipping_methods,"click",this.addShippingMethod.bind(this)),$(document).delegate(this.edit_shipping_method,"click",this.editShippingMethod.bind(this)),$(document).delegate(this.update_shipping_method,"click",this.updateShippingMethod.bind(this)),$(document).delegate(this.delete_shipping_method,"click",this.deleteShippingMethod.bind(this)),$(document).delegate(this.limit_zone_location,"click",this.limitZoneLocation.bind(this)),$(document).delegate(this.method_status,"change",this.toggleShippingMethod.bind(this)),$(document).delegate(this.modal_close_link,"click",this.closeModal.bind(this))},modifyShippingMethods:function(a,b){var c=this;$("#mvx_settings_form_shipping_by_zone").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),void 0!==a&&(a.preventDefault(),b=$(a.currentTarget).data("zoneId")),$.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:{action:"mvx-get-shipping-methods-by-zone",zoneID:b,security:mvx_vendor_shipping_script_data.security},success:function(a){$(c.vendor_shipping_methods).html(a.data.html).show(),$(c.shipping_zone_table).hide()},complete:function(){$("#mvx_settings_form_shipping_by_zone").unblock(),$(document).trigger("zone_settings_loaded")}})},zoneLoadedEvents:function(a){this.limitZoneLocation(a)},goToShippingZones:function(a){a.preventDefault(),$(this.vendor_shipping_methods).html("").hide(),$(this.shipping_zone_table).show(),window.location.reload()},onChangeShippingMethodSelector:function(){var a=$(this).find("option:selected").data("description");$(this).parents(".wc-shipping-zone-method-selector").find(".wc-shipping-zone-method-description").html(""),$(this).parents(".wc-shipping-zone-method-selector").find(".wc-shipping-zone-method-description").html(a)},showShippingMethods:function(a){a.preventDefault(),$("#mvx_shipping_method_add_container").show(),$("#mvx_shipping_method_add_container "+this.modal_dialog).show()},addShippingMethod:function(c){c.preventDefault();var e=this,a=$("#zone_id").val(),b=$("#shipping_method option:selected").val();if(""==a);else if(""==b);else{var d={action:"mvx-add-shipping-method",zoneID:a,method:b,security:mvx_vendor_shipping_script_data.security};$("#mvx_shipping_method_add_button").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),$.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:d,success:function(b){b.success&&($("#mvx_shipping_method_add_container").hide(),e.modifyShippingMethods(void 0,a))}})}},editShippingMethod:function(a){a.preventDefault(),$(".mvx-zone-method-content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var b=$(a.currentTarget).parents(".edit_del_actions").data("instance_id"),c=$(a.currentTarget).parents(".edit_del_actions").data("method_id"),d=$(a.currentTarget).parents(".edit_del_actions").data("zone_id"),e={action:"mvx-vendor-configure-shipping-method",zoneId:d,instanceId:b,methodId:c,security:mvx_vendor_shipping_script_data.security};$.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:e,success:function(a){a&&($(".mvx-zone-method-content").unblock(),$("#mvx_shipping_method_edit_container #method_id_selected").val(c),$("#mvx_shipping_method_edit_container #instance_id_selected").val(b),$("#mvx_shipping_method_edit_container #zone_id_selected").val(d),$("#shipping-form-fields").html(a.settings_html),$("#mvx_shipping_method_edit_container").show())}})},updateShippingMethod:function(b){b.preventDefault();var f=this,c=$("#mvx_shipping_method_edit_container #method_id_selected").val(),d=$("#mvx_shipping_method_edit_container #instance_id_selected").val(),a=$("#zone_id").val(),e={action:"mvx-update-shipping-method",zoneID:a,security:mvx_vendor_shipping_script_data.security,args:{instance_id:d,zone_id:a,method_id:c,settings:$("#mvx-vendor-edit-shipping-form").serializeArray()}};$("#mvx_shipping_method_edit_button").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),$.ajax({method:"POST",url:mvx_vendor_shipping_script_data.ajaxurl,data:e,success:function(b){b.success?f.modifyShippingMethods(void 0,a):alert(b.data)}})},deleteShippingMethod:function(a){a.preventDefault();var f=this;if(confirm(mvx_vendor_shipping_script_data.i18n.deleteShippingMethodConfirmation)){var e=$(a.target).is(this.delete_shipping_method)?a.target:$(a.target).closest(this.delete_shipping_method),b=$(e).parents(".edit_del_actions").attr("data-instance_id"),c=$("#zone_id").val(),d=d={action:"mvx-delete-shipping-method",zoneID:c,instance_id:b,security:mvx_vendor_shipping_script_data.security};""==c||""==b||$.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:d,success:function(a){a.success?f.modifyShippingMethods(void 0,c):alert(resp.data)}})}},limitZoneLocation:function(a){$("#limit_zone_location").is(":checked")?($(".hide_if_zone_not_limited").show(),$("#select_zone_states").select2()):$(".hide_if_zone_not_limited").hide()},toggleShippingMethod:function(a){a.preventDefault();var d=$(a.target).is(":checked"),b=$(a.target).val(),c=$("#zone_id").val(),e={action:"mvx-toggle-shipping-method",zoneID:c,instance_id:b,checked:d,security:mvx_vendor_shipping_script_data.security};""==c||""==b||($(".mvx-container").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),$.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:e,success:function(a){a.success?$(".mvx-container").unblock():($(".mvx-container").unblock(),alert(a.data))}}))},closeModal:function(a){a.preventDefault();var b=$(a.target).parents(this.modal_dialog);b.length&&(b.hide(),$(this.modal_dialog).hide())}};function b(a){var d=wc_country_select_params.countries.replace(/&quot;/g,'"'),b=$.parseJSON(d),c=a.val();if(b[c]){if($.isEmptyObject(b[c]))a.parent().find(".mvx_state_to_select").each(function(){$statebox_id=($statebox=$(this)).attr("id"),$statebox_name=$statebox.attr("name"),$statebox_val=$statebox.val(),null===$statebox_val&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),$statebox.is("select")&&$statebox.replaceWith('<input type="text" name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" value="'+$statebox_val+'" class="mvx-text mvx_state_to_select multi_input_block_element" />')});else{input_selected_state="";var e="",f=b[c];a.parent().find(".mvx_state_to_select").each(function(){for(var a in $statebox_id=($statebox=$(this)).attr("id"),$statebox_name=$statebox.attr("name"),$statebox_val=$statebox.val(),null===$statebox_val&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),f)if(f.hasOwnProperty(a)){if($statebox_val){if($statebox_val==a)var b='selected="selected"';else var b=""}e=e+'<option value="'+a+'"'+b+">"+f[a]+"</option>"}$statebox.is("select")&&$statebox.html('<option value="">'+wc_country_select_params.i18n_select_state_text+'</option><optgroup label="-------------------------------------"><option value="everywhere">'+mvx_vendor_shipping_script_data.everywhere_else_option+'</option></optgroup><optgroup label="-------------------------------------">'+e+"</optgroup>"),$statebox.is("input")&&($statebox.replaceWith('<select name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" class="mvx-select mvx_state_to_select multi_input_block_element"></select>'),($statebox=$("#"+$statebox_id)).html('<option value="">'+wc_country_select_params.i18n_select_state_text+'</option><optgroup label="-------------------------------------"><option value="everywhere">'+mvx_vendor_shipping_script_data.everywhere_else_option+'</option></optgroup><optgroup label="-------------------------------------">'+e+"</optgroup>")),$statebox.val($statebox_val)})}}else a.parent().find(".mvx_state_to_select").each(function(){$statebox_id=($statebox=$(this)).attr("id"),$statebox_name=$statebox.attr("name"),$statebox_val=$statebox.val(),null===$statebox_val&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),$statebox.is("select")&&$statebox.replaceWith('<input type="text" name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" value="'+$statebox_val+'" class="mvx-text mvx_state_to_select multi_input_block_element" />')})}function c(a){var b=a.data("limit");void 0===b&&(b=-1),1==a.children(".multi_input_block").length&&a.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),a.children(".multi_input_block").length==b?a.find(".add_multi_input_block").hide():a.find(".add_multi_input_block").show(),a.children(".multi_input_block").each(function(){$(this)[0]!=a.children(".multi_input_block:last")[0]&&$(this).children(".add_multi_input_block").remove(),$(this).children(".add_multi_input_block").attr("title",mvx_vendor_shipping_script_data.mvx_multiblick_addnew_help),$(this).children(".remove_multi_input_block").attr("title",mvx_vendor_shipping_script_data.mvx_multiblick_remove_help)}),a.children(".multi_input_block").children(".add_multi_input_block").off("click").on("click",function(){var f=a.attr("id"),g=a.data("name"),e=a.data("length");e++;var c=a.children(".multi_input_block:first").clone(!1);c.find("textarea,input:not(input[type=button],input[type=submit],input[type=checkbox],input[type=radio])").val(""),c.find("input[type=checkbox]").attr("checked",!1),c.find(".select2-container").remove(),c.find("select").select2(),c.find("select").select2("destroy"),c.children(".multi_input_block_element:not(.multi_input_holder)").each(function(){var a=$(this),b=a.data("name");a.hasClass("mvx-wp-fields-uploader")||a.hasClass("wp-picker-container")||(a.attr("name",g+"["+e+"]["+b+"]"),a.attr("id",f+"_"+b+"_"+e))}),c.children(".multi_input_holder").each(function(){d($(this),f,g,e)}),c.children(".remove_multi_input_block").off("click").on("click",function(){if(confirm(mvx_vendor_shipping_script_data.multiblock_delete_confirm)){var a=$(this).parent().parent(),c=a.children(".multi_input_block").children(".add_multi_input_block").clone(!0);$(this).parent().remove(),a.children(".multi_input_block").children(".add_multi_input_block").remove(),a.children(".multi_input_block:last").append(c),a.children(".multi_input_block").length==b?a.find(".add_multi_input_block").hide():a.find(".add_multi_input_block").show(),1==a.children(".multi_input_block").length&&a.children(".multi_input_block").children(".remove_multi_input_block").css("display","none")}}),c.children(".add_multi_input_block").remove(),a.append(c),a.children(".multi_input_block:last").append($(this)),a.children(".multi_input_block").length>1&&a.children(".multi_input_block").children(".remove_multi_input_block").css("display","block"),a.children(".multi_input_block").length==b?a.find(".add_multi_input_block").hide():a.find(".add_multi_input_block").show(),a.data("length",e),a.find(".field_type_options").each(function(){$(this).off("change").on("change",function(){$(this).parent().find(".field_type_select_options").hide(),$(this).parent().find(".field_type_html_options").hide(),"select"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"mselect"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"dropdown"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"html"==$(this).val()&&$(this).parent().find(".field_type_html_options").show()}).change()}),a.find(".custom_field_is_group").each(function(){$(this).change(function(){$(this).is(":checked")?$(this).parent().find(".custom_field_is_group_name").css("visibility","visible"):$(this).parent().find(".custom_field_is_group_name").css("visibility","hidden")}).change()})}),a.hasClass("multi_input_block_element"),a.children(".multi_input_block").children(".multi_input_holder").length,a.children(".multi_input_block").children(".remove_multi_input_block").off("click").on("click",function(){if(confirm(mvx_vendor_shipping_script_data.multiblock_delete_confirm)){var a=$(this).parent().parent(),c=a.children(".multi_input_block").children(".add_multi_input_block").clone(!0);$(this).parent().remove(),a.children(".multi_input_block").children(".add_multi_input_block").remove(),a.children(".multi_input_block:last").append(c),1==a.children(".multi_input_block").length&&a.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),a.children(".multi_input_block").length==b?a.find(".add_multi_input_block").hide():a.find(".add_multi_input_block").show()}}),a.find(".field_type_options").each(function(){$(this).off("change").on("change",function(){$(this).parent().find(".field_type_select_options").hide(),$(this).parent().find(".field_type_html_options").hide(),"select"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"mselect"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"dropdown"==$(this).val()?$(this).parent().find(".field_type_select_options").show():"html"==$(this).val()&&$(this).parent().find(".field_type_html_options").show()}).change()}),a.find(".custom_field_is_group").each(function(){$(this).change(function(){$(this).is(":checked")?$(this).parent().find(".custom_field_is_group_name").css("visibility","visible"):$(this).parent().find(".custom_field_is_group_name").css("visibility","hidden")}).change()})}function d(a,f,j,g){a.children(".multi_input_block:not(:last)").remove();for(var h=a.attr("id"),i=(h=h.replace(f+"_","")).split("_"),b="",e=0;e<i.length-1;e++)""!=b&&(b+="_"),b+=i[e];a.attr("data-name",j+"["+g+"]["+b+"]"),a.attr("id",f+"_"+b+"_"+g),a.children(".multi_input_block").children(".multi_input_block_element:not(.multi_input_holder)").each(function(){var a=$(this),c=a.data("name");if(a.hasClass("mvx-wp-fields-uploader"));else{var d=a.attr("multiple");void 0!==d&& !1!==d?a.attr("name",j+"["+g+"]["+b+"][0]["+c+"][]"):a.attr("name",j+"["+g+"]["+b+"][0]["+c+"]"),a.attr("id",f+"_"+b+"_"+g+"_"+c+"_0")}}),c(a),a.children(".multi_input_block").children(".multi_input_holder").length>0&&a.children(".multi_input_block").css("padding-bottom","40px"),a.children(".multi_input_block").children(".multi_input_holder").each(function(){d($(this),f+"_"+b+"_0",j+"["+g+"]["+b+"]",0)})}$(a.build.bind(a)),$("#shipping-options").change(function(){var a=$(this).val();"distance_by_shipping"==a?($("#mvx-vendor-shipping-by-distance-section").show(),$("#mvx-vendor-shipping-by-zone-section").hide(),$("#mvx-vendor-shipping-by-country-section").hide()):"distance_by_zone"==a?($("#mvx-vendor-shipping-by-distance-section").hide(),$("#mvx-vendor-shipping-by-zone-section").show(),$("#mvx-vendor-shipping-by-country-section").hide()):"shipping_by_country"==a&&($("#mvx-vendor-shipping-by-distance-section").hide(),$("#mvx-vendor-shipping-by-country-section").show(),$("#mvx-vendor-shipping-by-zone-section").hide())}),"distance_by_shipping"==$("#shipping-options").val()?($("#mvx-vendor-shipping-by-distance-section").show(),$("#mvx-vendor-shipping-by-zone-section").hide(),$("#mvx-vendor-shipping-by-country-section").hide()):"distance_by_zone"==$("#shipping-options").val()?($("#mvx-vendor-shipping-by-distance-section").hide(),$("#mvx-vendor-shipping-by-zone-section").show(),$("#mvx-vendor-shipping-by-country-section").hide()):"shipping_by_country"==$("#shipping-options").val()&&($("#mvx-vendor-shipping-by-distance-section").hide(),$("#mvx-vendor-shipping-by-zone-section").hide(),$("#mvx-vendor-shipping-by-country-section").show()),$(".mvx_country_to_select").select2(),$(".mvx-select").select2(),$(".mvx_country_to_select").each(function(){$(this).change(function(){b($(this))}).change()}),setTimeout(function(){$("#mvx_shipping_rates").children(".multi_input_block").children(".add_multi_input_block").click(function(){$("#mvx_shipping_rates").children(".multi_input_block:last").find(".mvx_country_to_select").select2(),$("#mvx_shipping_rates").children(".multi_input_block:last").find(".mvx_country_to_select").change(function(){b($(this))}).change()})},2e3),$(".multi_input_holder").each(function(){c($(this))})}(jQuery)