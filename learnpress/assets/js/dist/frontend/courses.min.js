(()=>{"use strict";if(void 0===lpGlobalSettings)throw new Error("lpGlobalSettings is undefined");const e={apiCourses:lpGlobalSettings.lp_rest_url+"lp/v1/courses/archive-course"};(()=>{if(void 0===lpGlobalSettings)return void console.log("lpGlobalSettings is undefined");const t=window.location.search,o=new URLSearchParams(t);let r,s,n,l,a,c,i={},u=!1,p=1;const d={};for(const[e,t]of o.entries())d[e]=t;if(window.localStorage.setItem("lp_filter_courses",JSON.stringify(d)),!lpGlobalSettings.lpArchiveLoadAjax)return void console.log("Option load courses ajax is disabled");const h=(e,t)=>{const o=new URL(e);return Object.keys(t).forEach((e=>{o.searchParams.set(e,t[e])})),o};window.lpArchiveRequestCourse=(t,o)=>{if(u)return;u=!0,s&&l.append(s);const i=h(e.apiCourses,{...lpGlobalSettings.lpArchiveSkeleton,...t}),d=e.apiCourses+i.search;let v={method:"GET"};0!==lpGlobalSettings.user_id&&(v={...v,headers:{"X-WP-Nonce":lpGlobalSettings.nonce}}),fetch(d,v).then((e=>e.json())).then((e=>{if(a=e.data.content||"",c=e.data.pagination||"",!s&&r&&(s=r.cloneNode(!0)),!p){l.innerHTML=a;const e=c,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&(l.after(t),g())}}wp.hooks.doAction("lp-js-get-courses",e),"function"==typeof o&&o(e)})).catch((e=>{l.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/v1/courses/archive-course"}</div>`})).finally((()=>{u=!1;const e=document.querySelector("form.search-courses button");if(e&&e.classList.remove("loading"),p)p=0;else{const e={behavior:"smooth"};n.scrollIntoView(e)}window.localStorage.setItem("lp_filter_courses",JSON.stringify(t));const o=h(document.location,t);window.history.pushState("","",o)}))},lpGlobalSettings.lpArchiveNoLoadAjaxFirst?p=0:lpArchiveRequestCourse(i);const g=()=>{const e=document.querySelectorAll(".lp-archive-courses .learn-press-pagination .page-numbers");e.length>0&&e.forEach((t=>t.addEventListener("click",(o=>{if(o.preventDefault(),o.stopPropagation(),n&&(r&&(r.style.display="block"),n.scrollIntoView({behavior:"smooth"}),i=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{},o.currentTarget.getAttribute("href"))){const r=[...e].filter((e=>e.classList.contains("current"))),s=o.currentTarget.textContent||t.classList.contains("next")&&parseInt(r[0].textContent)+1||t.classList.contains("prev")&&parseInt(r[0].textContent)-1;i.paged=s,lpArchiveRequestCourse({...i})}}))))},v=()=>{(()=>{if(!lpGlobalSettings.lpArchiveNoLoadAjaxFirst){l.innerHTML=a;const e=c,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&l.after(t)}}g(),(()=>{const e=document.querySelectorAll("form.search-courses");i=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{},e.forEach((e=>{const t=e.querySelector('input[name="c_search"]'),o=e.querySelector('[type="submit"]');let s;t.addEventListener("keyup",(e=>{r&&(r.style.display="block"),e.preventDefault();const t=e.target.value.trim();(!t||t&&t.length>2)&&(void 0!==s&&clearTimeout(s),s=setTimeout((function(){o.classList.add("loading"),i.c_search=t,i.paged=1,lpArchiveRequestCourse({...i})}),800))})),e.addEventListener("submit",(t=>{t.preventDefault();const o=e.querySelector('input[name="c_search"]');o&&o.dispatchEvent(new Event("keyup"))}))}))})()})(),(()=>{const e=document.querySelectorAll('.lp-archive-courses input[name="lp-switch-layout-btn"]');e.length>0&&e.forEach((e=>e.addEventListener("change",(e=>{e.preventDefault();const t=e.target.value;if(t){const e=document.querySelector(".lp-archive-courses .learn-press-courses[data-layout]");e&&(e.dataset.layout=t),LP.Cookies.set("courses-layout",t)}}))))})(),(()=>{const e=LP.Cookies.get("courses-layout"),t=document.querySelectorAll('.lp-courses-bar .switch-layout [name="lp-switch-layout-btn"]');t.length>0&&[...t].map((t=>t.value===e&&(t.checked=!0)))})()},m=setInterval((function(){r=document.querySelector(".lp-archive-course-skeleton"),n=document.querySelector(".lp-archive-courses"),n&&(l=n.querySelector("ul.learn-press-courses"));let e=!1;l&&r&&((lpGlobalSettings.lpArchiveNoLoadAjaxFirst||a)&&(e=!0),e&&(v(),clearInterval(m)))}),1)})()})();