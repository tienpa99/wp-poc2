jQuery(document).ready(function($){var avNonce=av_settings.nonce;var avMsg1=av_settings.msg_1;var avMsg3=av_settings.msg_3;var avMsg4=av_settings.msg_4;var avFiles=[];var avFilesLoaded;function checkThemeFile(current){var id=parseInt(current||0);var file=avFiles[id];$.post(ajaxurl,{action:'get_ajax_response',_ajax_nonce:avNonce,_theme_file:file,_action_request:'check_theme_file',},function(input){var item=$('#av_template_'+id);var i;var lines;var line;var md5;if(input){if(!input.nonce||input.nonce!==avNonce){return}
item.addClass('danger');lines=input.data;for(i=0;i<lines.length;i=i+3){md5=lines[i+2];line=lines[i+1].replace(/@span@/g,'<span>').replace(/@\/span@/g,'</span>');item.append('<p><a href="#" id="'+md5+'" class="button" title="'+avMsg4+'">'+avMsg1+'</a> <code>'+line+'</code></p>');$('#'+md5).click(function(){$.post(ajaxurl,{action:'get_ajax_response',_ajax_nonce:avNonce,_file_md5:$(this).attr('id'),_action_request:'update_white_list',},function(res){var parent;if(!res){return}
if(!res.nonce||res.nonce!==avNonce){return}
parent=$('#'+res.data[0]).parent();if(parent.parent().children().length<=1){parent.parent().hide('slow').remove()}
parent.hide('slow').remove()});return!1})}}else{item.addClass('done')}
avFilesLoaded++;if(avFilesLoaded>=avFiles.length){$('#av_manual_scan .alert').text(avMsg3).fadeIn().fadeOut().fadeIn().fadeOut().fadeIn().animate({opacity:1.0},500).fadeOut('slow',function(){$(this).empty()})}else{checkThemeFile(id+1)}})}
$('#av_manual_scan a.button').click(function(){$.post(ajaxurl,{action:'get_ajax_response',_ajax_nonce:avNonce,_action_request:'get_theme_files',},function(input){var output='';if(!input){return}
if(!input.nonce||input.nonce!==avNonce){return}
avFiles=input.data;avFilesLoaded=0;jQuery.each(avFiles,function(i,val){output+='<div id="av_template_'+i+'">'+val+'</div>'});$('#av_manual_scan .alert').empty();$('#av_manual_scan .output').empty().append(output);checkThemeFile()});return!1});function manageOptions(){var cbSelectors=['#av_cronjob_enable','#av_safe_browsing','#av_checksum_verifier'];var anyEnabled=!1;cbSelectors.forEach(function(c){var cb=$(c);var inputs=cb.parents('fieldset').find(':text, :checkbox').not(cb);var enabled;if(typeof $.fn.prop==='function'){enabled=!!cb.prop('checked');inputs.prop('disabled',!enabled)}else{enabled=!!cb.attr('checked');inputs.attr('disabled',!enabled)}
anyEnabled=anyEnabled||enabled});if(typeof $.fn.prop==='function'){$('#av_notify_email').prop('disabled',!anyEnabled)}else{$('#av_notify_email').attr('disabled',!anyEnabled)}}
$('#av_settings input[type=checkbox]').click(manageOptions);manageOptions()})